"use strict";(self.webpackChunkorb_study=self.webpackChunkorb_study||[]).push([[191],{3191:function(e,n,t){t.r(n),t.d(n,{default:function(){return Te}});var r=t(5861),i=t(5671),o=t(3144),a=t(7757),s=t.n(a),c=t(9340),u=t(6215),l=t(1120),v=t(2212);var d=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e;return(0,i.Z)(this,a),(e=r.call(this,{canvas:document.getElementById("experience"),antialias:!1,powerPreference:"high-performance"})).DPI=Math.min(2,window.devicePixelRatio),e.setPixelRatio(e.DPI),e.setSize(window.innerWidth,window.innerHeight),e}return(0,o.Z)(a,null,[{key:"getInstance",value:function(){return a.instance||(a.instance=new this),a.instance}}]),a}(v.WebGLRenderer),f=t(1752);var h=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){return(0,i.Z)(this,a),r.call(this)}return(0,o.Z)(a,null,[{key:"getInstance",value:function(){return a.instance||(a.instance=new this),a.instance}}]),a}(v.Scene),g=t(2886),m=(t(5449),function(e){var n=window.location.search,t=new URLSearchParams(n),r=t.has(e);return t.has("debug")&&r}),p=function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.msMaxTouchPoints||!1},y=m("debug"),x=m("fps"),w=m("drawcount"),b=(m("gui"),m("controls")),P={USE_POSTPROCESS:!0,DEBUG_FPS:y&&x,DEBUG_DRAW_COUNT:y&&w,USE_ORBIT_CONTROLS:y&&b,USE_GUI:!0,USE_XR:"undefined"!=typeof XR},S=t(3466),R="glResizeTopic",_="glUpdateTopic",z="glTouchMoveTopic",E=t(211),C=t(6008),L=t(5709),Z=new E.xQ,k=function(e,n){Z.next({topic:e,data:n})},T=function(e,n){Z.pipe((0,C.h)((function(n){return n.topic===e})),(0,L.U)((function(e){return e.data}))).subscribe(n)},U=t(840),D=t.n(U),A=function(){function e(){(0,i.Z)(this,e),this._createListeners()}return(0,o.Z)(e,[{key:"_createListeners",value:function(){var e=this;if(window.addEventListener("resize",this.onResize.bind(this)),p()){window.addEventListener("touchstart",this.onTouch.bind(this)),window.addEventListener("touchend",this.onTouchEnd.bind(this)),window.addEventListener("touchmove",this.onMouseMove.bind(this));var n=new(D().Manager)(document.body),t=new(D().Pinch),r=new(D().Press),i=new(D().Tap),o=new(D().Pan);o.set({direction:D().DIRECTION_VERTICAL,threshold:1,velocity:.1}),n.add([t,r,o,i]),n.on("tap",(function(n){var t={normalized:{x:n.center.x/e.width*2-1,y:-n.center.y/e.height*2+1},raw:{x:n.center.x,y:n.center.y},rawNormalized:{x:2*(n.center.x-.5*e.width),y:2*(n.center.y-.5*e.height)}};k("glTapTopic",t)})),n.on("pinch",(function(e){k("glPinchTopic",e)})),n.on("press",(function(e){k("glLongPressTopic",e)})),n.on("pressup",(function(e){k("glLongPressTopicUp",e)})),n.on("panmove",(function(e){k("glPanTopic",e)})),n.on("pandown panup panend",(function(e){var n=!1;"panend"===e.type&&(e.velocityY<-.3&&e.distance>10&&(n=!0,e.angle<-60&&e.angle>-120&&k("glSwipeUpTopic",e)),e.velocityY>.3&&e.distance>10&&(n=!0,e.angle>60&&e.angle<120&&k("glSwipeDownTopic",e)),n||k("glPanEndTopic",e))}))}else window.addEventListener("mousedown",this.onTouch.bind(this)),window.addEventListener("mouseup",this.onTouchEnd.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("wheel",this.onWheel.bind(this))}},{key:"removeListeners",value:function(){p()?(window.removeEventListener("touchstart",this.onPress.bind(this)),window.removeEventListener("touchend",this.onPress.bind(this)),window.removeEventListener("touchmove",this.onPressMove.bind(this))):(window.removeEventListener("mousedown",this.onPress.bind(this)),window.removeEventListener("mouseup",this.onPress.bind(this)),window.removeEventListener("mousemove",this.onPressMove.bind(this)),window.removeEventListener("wheel",this.onWheel.bind(this))),window.removeEventListener("resize",this.onResize.bind(this))}},{key:"onTouch",value:function(e){this.mouse=this.getMouse(e),k("glTouchStartTopic",this.mouse)}},{key:"onTouchEnd",value:function(e){this.mouse=this.getMouse(e),k("glTouchEndTopic",this.mouse)}},{key:"onWheel",value:function(e){k("glWheelTopic",{deltaY:e.deltaY,deltaX:e.deltaX,direction:Math.sign(e.deltaY)})}},{key:"onResize",value:function(){k(R)}},{key:"onMouseMove",value:function(e){e.touches&&e.touches.length>1||(e.preventDefault(),e.stopPropagation(),this.mouse=this.getMouse(e),k(z,this.mouse))}},{key:"getMouse",value:function(e){return e.changedTouches&&(e=e.changedTouches[0]),{normalized:{x:e.clientX/this.width*2-1,y:-e.clientY/this.height*2+1},raw:{x:e.clientX,y:e.clientY},rawNormalized:{x:2*(e.clientX-.5*this.width),y:2*(e.clientY-.5*this.height)}}}}]),e}(),M=t(5108);var I=P.DEBUG_FPS,B=P.USE_ORBIT_CONTROLS,O=P.DEBUG_DRAW_COUNT,G=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e;return(0,i.Z)(this,a),(e=r.call(this)).clock=new v.Clock,e.isRunning=!1,e.requestFrame=null,e.elapsed=null,e.mouse={},e.width=window.innerWidth,e.height=window.innerHeight,e.mediator=ae.getInstance(),e.camera=e.mediator.camera,e.renderer=d.getInstance(),e.canvas=e.renderer.domElement,I&&(e.stats=new S,e.stats.showPanel(0),document.body.appendChild(e.stats.dom)),B&&(e.controls=null,e.initControls(),document.getElementById("ui").style.pointerEvents="none"),O&&(e.drawCallCount=0,e.renderer.info.autoReset=!1),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState?e.start():e.pause()})),e}return(0,o.Z)(a,[{key:"start",value:function(){this.clock.start(),this.isRunning=!0,this.run()}},{key:"initControls",value:function(){this.controls=new g.z(this.camera,this.renderer.domElement),this.controls.enabled=!0,this.controls.enableDamping=!0,this.controls.dampingFactor=.08,this.controls.enablePan=!0,this.controls.update()}},{key:"pause",value:function(){this.clock.stop(),this.requestFrame&&(cancelAnimationFrame(this.requestFrame),this.requestFrame=null),this.isRunning=!1}},{key:"earlyUpdate",value:function(e,n){k("glEarlyUpdateTopic",{elapsed:e,delta:n})}},{key:"update",value:function(e,n){k(_,{elapsed:e,delta:n})}},{key:"lateUpdate",value:function(e,n){k("glLateUpdateTopic",{elapsed:e,delta:n})}},{key:"run",value:function(){var e=P.DEBUG_FPS;this.controls&&this.controls.update();var n=this.clock.getDelta();if(this.elapsed=this.clock.getElapsedTime(),e&&this.stats.begin(),this.earlyUpdate(this.elapsed,n),this.update(this.elapsed,n),this.lateUpdate(this.elapsed,n),e&&this.stats.end(),O){var t=this.renderer.info.render.calls;this.drawCallCount!=t&&M.log("Draw call count: ",t),this.drawCallCount=t,this.renderer.info.reset()}this.isRunning&&(this.requestFrame=requestAnimationFrame(this.run.bind(this)))}}]),a}(A),W=t(885);var F=function(e){(0,c.Z)(o,e);var n,t,r=(n=o,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function o(){var e;return(0,i.Z)(this,o),(e=r.call(this)).setIndex([2,1,0]),e.setAttribute("position",new v.Float32BufferAttribute([-1,-1,0,-1,4,0,4,-1,0],3)),e.needsUpdate=!0,e}return o}(v.BufferGeometry),N="#define GLSLIFY 1\nvarying vec2 vUv;\nuniform sampler2D mapDiffuse;\n\nvoid main() {\n\n    vec2 st = vUv;\n\n    vec3 diffuse = texture2D( mapDiffuse, vUv ).rgb;\n\n    gl_FragColor.rgb = diffuse;\n\n    gl_FragColor.a = 1.0;\n\n}",V="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvUv = vec2( 0.5 ) + ( position.xy ) * 0.5;\n\n\tgl_Position = vec4( position.xy, 0.0,  1.0 );\n    \n}",j=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.sampleCount,r=void 0===t?4:t,o=n.isWebGL2,a=void 0!==o&&o;(0,i.Z)(this,e),a?(this.target=new v.WebGLMultisampleRenderTarget(1,1,{format:v.RGBFormat}),this.target.samples=r):this.target=new v.WebGLRenderTarget(1,1,{minFilter:v.LinearFilter,magFilter:v.LinearFilter,stencilBuffer:!1,format:v.RGBFormat}),this.shader=new v.ShaderMaterial({vertexShader:V,fragmentShader:N,uniforms:{mapDiffuse:{value:this.target}},depthTest:!1,depthWrite:!1}),this.resolution=1,this.screen=new v.Mesh(new F,this.shader),this.screen.frustumCulled=!1,this.postScene=new v.Scene,this.postScene.autoUpdate=!1,this.postScene.add(this.screen)}return(0,o.Z)(e,[{key:"resize",value:function(e,n){this.target.setSize(e*this.resolution,n*this.resolution)}},{key:"render",value:function(e,n,t,r){e.setRenderTarget(this.target),e.render(n,t),e.setRenderTarget(null),r&&e.render(this.postScene,t)}}]),e}(),q=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.shader,r=n.isWebGL2,o=void 0!==r&&r,a=n.sampleCount,s=void 0===a?1:a;(0,i.Z)(this,e),o?(this.target=new v.WebGLMultisampleRenderTarget(1,1,{minFilter:v.LinearFilter,magFilter:v.LinearFilter,stencilBuffer:!1,format:v.RGBFormat}),this.target.samples=s):this.target=new v.WebGLRenderTarget(1,1,{minFilter:v.LinearFilter,magFilter:v.LinearFilter,stencilBuffer:!1,format:v.RGBFormat}),this.shader=t,this.screen=new v.Mesh(new F,this.shader),this.screen.frustumCulled=!1,this.postScene=new v.Scene,this.postScene.autoUpdate=!1,this.postScene.add(this.screen)}return(0,o.Z)(e,[{key:"render",value:function(e,n,t,r){this.shader.uniforms.mapDiffuse.value=t,r||e.setRenderTarget(this.target),e.render(this.postScene,n),e.setRenderTarget(null)}},{key:"resize",value:function(e,n){this.target.setSize(e,n)}}]),e}();var H=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){(0,i.Z)(this,a);var e={mapDiffuse:{value:null},vignetteRadius:{value:1},vignetteSmoothness:{value:.3},radialIntensity:{value:0},radialDirection:{value:new v.Vector2(.5,.5)},radialSettings:{value:new v.Vector3(.85,5,1)},time:{value:0},resolution:{value:new v.Vector2(window.innerWidth,window.innerHeight)}};return r.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvUv = vec2( 0.5 ) + ( position.xy ) * 0.5;\n\n\tgl_Position = vec4( position.xy, 0.0,  1.0 );\n    \n}",fragmentShader:'#define GLSLIFY 1\n#include <common>\n\nvarying vec2 vUv;\n\nuniform sampler2D mapDiffuse;\nuniform sampler2D mapBlurScreen;\nuniform sampler2D mapRipple;\n\nuniform float vignetteRadius;\nuniform float vignetteSmoothness;\nuniform float blurAmount;\nuniform float radialIntensity;\nuniform float time;\nuniform vec2 resolution;\nuniform vec2 radialDirection;\nuniform vec3 radialSettings;\n\nconst highp float noiseGranularity = 3.0 / 255.0;\n\nfloat vignette( vec2 uv, float radius, float smoothness ) {\n\n\tfloat diff = radius - distance(uv, vec2(0.5, 0.5));\n\treturn smoothstep(-smoothness, smoothness, diff);\n\n}\n\nvec3 dithering( vec3 color ) {\n\n  float grid_position    = rand( gl_FragCoord.xy );\n  vec3  dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n        dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n  return color + dither_shift_RGB;\n\n}\n\nvec3 rgb2hsv(vec3 c) {\n\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n  vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nhighp float random(vec2 coords) {\n\n   return fract( sin( dot( coords.xy, vec2( 12.9898,78.233 ) ) ) * 43758.5453 );\n\n}\n\nvec3 gammaCorrect(vec3 color, float gamma){\n\n    return pow(color, vec3(1.0/gamma));\n\n}\n\nvec3 levelRange(vec3 color, float minInput, float maxInput){\n\n    return min(max(color - vec3(minInput), vec3(0.0)) / (vec3(maxInput) - vec3(minInput)), vec3(1.0));\n\n}\n\nvec3 finalLevels(vec3 color, float minInput, float gamma, float maxInput){\n\n    return gammaCorrect(levelRange(color, minInput, maxInput), gamma);\n\n}\n\nvec4 bokeh(vec2 uv, float rad)\n{ // based on dof by Jochen "Virgill" Feldk√∂tter, Alcatraz / Rhodium 4k Intro liquid carbon\n  // simplyfied version of Dave Hoskins blur\n  // now bokeh is not cut within dof mask, added alpha blending based on difference of dof mask samples\n    const float GA =2.399;\n\t  const mat2 rot = mat2(cos(GA),sin(GA),-sin(GA),cos(GA));\n\t  vec4 acc = vec4(texture(mapDiffuse,uv).rgb, rad);\n    float d = rad;\n    vec2 pixel=0.0002*vec2(5.*resolution.y/resolution.x,7.);\n\t  vec2 angle=vec2(0,rad);\n    for (int j=0;j<80;j++)\n      {\n          rad += 1./rad;\n        angle*=rot;\n          vec4 col=texture(mapDiffuse, uv+pixel*(rad-1.)*angle);\n          acc.rgb = max(acc.rgb,col.rgb);\n          acc.a = max(acc.a, 1.0);\n    }\n\t  return acc;\n}\n\nvoid main() {\n\n  const float NOISE_GRANULARITY = 8.0 / 255.0;\n\n  int sampleCount = int(radialSettings.y);\n  float blur = radialSettings.z;\n  float falloff = radialSettings.x;\n\n  vec4  diffuse      = texture2D( mapDiffuse, vUv );\n  vec4  color        = diffuse;\n\n  vec2 destCoord = vUv;\n\n  vec2 dir = radialDirection;\n\n  vec2 direction = normalize( destCoord - dir );\n  vec2 velocity = direction * blur * pow( length( destCoord - dir ), falloff );\n  float inverseSampleCount = 1.0 / float( sampleCount );\n\n  mat3x2 increments = mat3x2( velocity * 1.0 * inverseSampleCount,\n                              velocity * 2.0 * inverseSampleCount,\n                              velocity * 4.0 * inverseSampleCount );\n\n  vec3 accumulator = vec3( 0 );\n  mat3x2 offsets = mat3x2( 0 );\n\n  for ( int i = 0; i < sampleCount; i++ ) {\n      accumulator += texture2D( mapDiffuse, destCoord + offsets[ 0 ] ).rgb;\n      offsets -= increments;\n  }\n\n  vec3 radial = accumulator / float( sampleCount );\n\n  vec3 outColor = mix( color.rgb, radial, radialIntensity );\n\n  outColor += mix(-NOISE_GRANULARITY, NOISE_GRANULARITY, random(destCoord));\n\n  outColor *= vignette( vUv, vignetteRadius, vignetteSmoothness );\n\n  gl_FragColor = vec4( outColor, 1.0 );\n\n}',uniforms:e,depthTest:!1,depthWrite:!1,precision:"lowp",extensions:{derivatives:!0}})}return(0,o.Z)(a,[{key:"resize",value:function(e,n){this.uniforms.resolution.value=new v.Vector2(e,n)}}]),a}(v.ShaderMaterial);var X=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){(0,i.Z)(this,a);var e={mapDiffuse:{value:null},resolution:{value:new v.Vector2(window.innerWidth*window.devicePixelRatio,window.innerHeight*window.devicePixelRatio)}};return r.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec2 resolution;\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n\t\t\tout vec2 v_rgbNW, out vec2 v_rgbNE,\n\t\t\tout vec2 v_rgbSW, out vec2 v_rgbSE,\n\t\t\tout vec2 v_rgbM) {\n\n\tvec2 inverseVP = 1.0 / resolution.xy;\n\tv_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n\tv_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n\tv_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n\tv_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n\tv_rgbM = vec2(fragCoord * inverseVP);\n\n}\n\nvoid main() {\n\n\tvUv = vec2( 0.5 ) + ( position.xy ) * 0.5;\n\n  texcoords(vUv * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n\tgl_Position = vec4( position.xy, 0.0,  1.0 );\n\n}",fragmentShader:"precision highp float;\n#define GLSLIFY 1\nuniform sampler2D   mapDiffuse;\nuniform vec2        resolution;\nvarying vec2        vUv;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n#define FXAA_REDUCE_MIN   (1.0/128.0)\n#define FXAA_REDUCE_MUL   (1.0/8.0)\n#define FXAA_SPAN_MAX     24.0\n\nmediump float when_gt(float x, float y) {\n  return max(sign(x - y), 0.0);\n}\n\nmediump float when_lt(float x, float y) {\n  return max(sign(y - x), 0.0);\n}\n\nmediump float orValue(float a, float b) {\n  return min(a + b, 1.0);\n}\n\nvoid main() {\n\n    vec2 res = vec2( 1.0 ) / resolution;\n\n    vec3 rgbNW = texture2D( mapDiffuse, v_rgbNW ).xyz;\n    vec3 rgbNE = texture2D( mapDiffuse, v_rgbNE ).xyz;\n    vec3 rgbSW = texture2D( mapDiffuse, v_rgbSW ).xyz;\n    vec3 rgbSE = texture2D( mapDiffuse, v_rgbSE ).xyz;\n    vec4 rgbaM  = texture2D( mapDiffuse,  v_rgbM );\n\n    vec3 rgbM  = rgbaM.xyz;\n    vec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n    float lumaNW = dot( rgbNW, luma );\n    float lumaNE = dot( rgbNE, luma );\n    float lumaSW = dot( rgbSW, luma );\n    float lumaSE = dot( rgbSE, luma );\n    float lumaM  = dot( rgbM,  luma );\n    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\n    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\n\n    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\n    dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\n          max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                dir * rcpDirMin)) * res;\n    vec4 rgbA = (1.0/2.0) * (\n    texture2D(mapDiffuse,  vUv.xy + dir * (1.0/3.0 - 0.5)) +\n    texture2D(mapDiffuse,  vUv.xy + dir * (2.0/3.0 - 0.5)));\n    vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\n    texture2D(mapDiffuse,  vUv.xy + dir * (0.0/3.0 - 0.5)) +\n    texture2D(mapDiffuse,  vUv.xy + dir * (3.0/3.0 - 0.5)));\n    float lumaB = dot(rgbB, vec4(luma, 0.0));\n\n    float conditional = orValue( when_lt( lumaB, lumaMin ), when_gt( lumaB,lumaMax ) );\n\n    gl_FragColor = mix( rgbB, rgbA, conditional);\n\n}",uniforms:e,depthTest:!1,depthWrite:!1})}return(0,o.Z)(a,[{key:"resize",value:function(e,n){this.uniforms.resolution.value=new v.Vector2(e,n)}}]),a}(v.ShaderMaterial),Y=new(t(7637).ZP);P.USE_GUI||Y.hide();var K=t(5108),J=function(){function e(){(0,i.Z)(this,e),this.renderer=d.getInstance(),this.isWebGL2=!1,this.fxaaShader=new X,this.compositionShader=new H,this.renderPass=new j({sampleCount:4,isWebGL2:this.isWebGL2}),this.fxaaPass=new q({shader:this.fxaaShader,isWebGL2:this.isWebGL2}),this.compositionPass=new q({shader:this.compositionShader,isWebGL2:this.isWebGL2}),this.postParams={radialIntensity:.3,radialDirection:new v.Vector2(.5,.5),radialSettings:new v.Vector3(.85,5,1),saveToText:function(){var e=Y.save();!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"settings",t=new Blob([e],{type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"txt"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,n);else{var r=document.createElement("a"),i=URL.createObjectURL(t);r.href=i,r.download=n,document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(i)}),0)}}(JSON.stringify(e.folders))},saveToLocalStorage:function(){var e=Y.save();window.localStorage.setItem("etherealGui",JSON.stringify(e))},loadFromLocalStorage:function(){var e=window.localStorage.getItem("etherealGui");K.log(e),window.localStorage.getItem("etherealGui",e),Y.load(JSON.parse(e))},reset:function(){Y.reset()}},this.initGui(),this.oldEnv=null,this.resize(),T(R,this.resize.bind(this))}return(0,o.Z)(e,[{key:"initGui",value:function(){var e=Y.addFolder("post");Y.add(this.postParams,"saveToText"),Y.add(this.postParams,"saveToLocalStorage"),Y.add(this.postParams,"loadFromLocalStorage"),Y.add(this.postParams,"reset"),e.add(this.postParams,"radialIntensity",0,2),e.add(this.postParams.radialDirection,"x",0,1).name("radial direction x"),e.add(this.postParams.radialDirection,"y",0,1).name("radial direction y"),e.add(this.postParams.radialSettings,"x",0,1).name("radial falloff"),e.add(this.postParams.radialSettings,"y",0,15).name("radial steps"),e.add(this.postParams.radialSettings,"z",0,3).name("radial blur")}},{key:"resize",value:function(){var e=this.renderer.getPixelRatio(),n=window.innerWidth*e,t=window.innerHeight*e;this.fxaaShader.resize(n,t),this.compositionShader.resize(n,t),this.renderPass.resize(n,t),this.fxaaPass.resize(n,t),this.compositionPass.resize(n,t)}},{key:"_assignGUIProperties",value:function(e){e.addFolder("Post processing settings")}},{key:"render",value:function(e,n,t){this.renderPass.render(this.renderer,e,n,!1),this.renderer.DPI<2&&this.fxaaPass.render(this.renderer,n,this.renderPass.target.texture,!1);for(var r=0,i=Object.entries(this.postParams);r<i.length;r++){var o=(0,W.Z)(i[r],2),a=o[0],s=o[1];"saveToText"!==a&&"saveToLocalStorage"!==a&&"loadFromLocalStorage"!==a&&"reset"!==a&&(this.compositionShader.uniforms[a].value=s)}this.compositionShader.uniforms.time.value=t,this.compositionPass.render(this.renderer,n,this.renderer.DPI<2?this.fxaaPass.target.texture:this.renderPass.target.texture,!0)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new this),e.instance}}]),e}(),Q=J,$=t(7326);var ee=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e;(0,i.Z)(this,a);var n={one:{edge:0,scale:.2,color:new v.Color("rgb(152, 153, 50)"),distortionAmount:2,position:new v.Vector2(.35,.5)},two:{edge:0,scale:.25,color:new v.Color("rgb( 172, 65, 123 )"),distortionAmount:2,position:new v.Vector2(.5,.4)},three:{edge:0,scale:.2,color:new v.Color("rgb( 255, 0, 0 )"),distortionAmount:2,position:new v.Vector2(.5,.5)},four:{edge:0,scale:.4,color:new v.Color("rgb( 169, 115, 255 )"),distortionAmount:2,position:new v.Vector2(.6,.5)},five:{edge:-.08,scale:.2,color:new v.Color("rgb( 255, 255, 255 )"),distortionAmount:2,position:new v.Vector2(.5,.5)}},t=Object.values(n),o={matcap:{value:null},time:{value:null},lights:{value:t},backgroundColor:{value:new v.Color(0)},resolution:{value:new v.Vector2(window.innerWidth,window.innerHeight)}};return(e=r.call(this,{vertexShader:"#define GLSLIFY 1\nvarying vec3 vViewPosition;\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldNormal;\nvarying vec3 vWorldPosition;\n\nvoid main() {\n\n  vUv = vec2( 0.5 ) + ( position.xy ) * 0.5;\n\n\tgl_Position = vec4( position.xy, 0.0,  1.0 );\n\n}",fragmentShader:"precision lowp float;\n#define GLSLIFY 1\n\nuniform float time;\nuniform float lightDistortionAmount;\nuniform vec2 resolution;\nuniform vec3 backgroundColor;\nvarying vec2 vUv;\n\nvec3 mod289(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\nfloat pnoise(vec3 P, vec3 rep)\n{\n  vec3 Pi0 = mod(floor(P), rep);\n  vec3 Pi1 = mod(Pi0 + vec3(1.0), rep);\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P);\n  vec3 Pf1 = Pf0 - vec3(1.0);\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat random(vec2 coords) {\n   return fract(sin(dot(coords.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nfloat sdfCircle(vec2 uv, vec2 offset, float distortionAmount )\n{\n  float x = uv.x - offset.x;\n  float y = uv.y - offset.y;\n  float a =length(vec2(x, y));\n  return a;\n}\n\nfloat sdfCircleB(vec2 uv, vec2 offset, float r )\n{\n  float x = uv.x - offset.x;\n  float y = uv.y - offset.y;\n  float a = length(vec2(x, y)) - r;\n  return a;\n}\n\nvec3 rgb( vec3 col )\n{\n  return col / 255.;\n}\n\nvec3 drawBackground()\n{\n  return backgroundColor;\n}\n\nstruct Light {\n    float edge;\n    float scale;\n    vec3 color;\n    float distortionAmount;\n    vec2 position;\n};\n\nconst int lightCount = 7;\n\nuniform Light lights[ LIGHT_COUNT ];\n\nvec4 drawScene( vec2 uv, vec2 mouse )\n{\n\n  vec2 scaledUV = uv;\n\n  scaledUV -= 0.5;\n  scaledUV *= 1.0;\n  scaledUV += 0.5;\n\n  vec4 col = vec4( drawBackground(), 1.0 );\n\n for( int i = 0; i < LIGHT_COUNT; i++ )\n  {\n      Light l = lights[i];\n      float getLight = sdfCircle( scaledUV, l.position, l.distortionAmount );\n      col = vec4( mix( l.color, col.rgb, smoothstep(l.edge, l.scale, getLight ) ), 1.0 );\n\n  }\n\n  return col;\n}\n\nvoid main()\n{\n\n  vec2 uv = vUv;\n  uv -= 0.5;\n  uv.x *= resolution.x / resolution.y;\n  uv += 0.5;\n\n  vec2 mouse = vec2( 0.0 );\n  vec4 col = drawScene( uv, mouse );\n\n  // post\n  col.rgb *= 1.5;\n\n  gl_FragColor = vec4( col.rgb, col.a );\n\n}",uniforms:o,transparent:!0,defines:{LIGHT_COUNT:t.length}})).params={backgroundColor:new v.Color(0)},e.initGui(n),T(_,e.handleUpdate.bind((0,$.Z)(e))),e}return(0,o.Z)(a,[{key:"initGui",value:function(e){var n=Y.addFolder("lights");n.addColor(this.params,"backgroundColor");for(var t=0,r=Object.entries(e);t<r.length;t++){var i=(0,W.Z)(r[t],2),o=i[0],a=i[1],s=n.addFolder(o);s.add(a,"edge",-1,1),s.add(a,"scale",0,1),s.add(a.position,"x",0,1),s.add(a.position,"y",0,1),s.addColor(a,"color")}}},{key:"handleUpdate",value:function(e){for(var n=e.elapsed,t=0,r=Object.entries(this.params);t<r.length;t++){var i=(0,W.Z)(r[t],2),o=i[0],a=i[1];this.uniforms[o].value=a}this.uniforms.time.value=n}}]),a}(v.ShaderMaterial);var ne=function(e){(0,c.Z)(f,e);var n,t,a,d=(t=f,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,l.Z)(t);if(a){var r=(0,l.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function f(){var e;(0,i.Z)(this,f);var n=new F;return(e=d.call(this,n)).textureLoader=new v.TextureLoader,e.frustumCulled=!1,e.loadAssets(),e}return(0,o.Z)(f,[{key:"loadAssets",value:(n=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onAssetsLoaded();case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onAssetsLoaded",value:function(){this.material=new ee,this.material.needsUpdate=!0}}]),f}(v.Mesh);var te=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e;return(0,i.Z)(this,a),(e=r.call(this)).mediator=ae.getInstance(),e.camera=e.mediator.camera,e.renderer=d.getInstance(),e.scene=h.getInstance(),e.postProcess=Q.getInstance(),e.ethereal=new ne,e.scene.add(e.ethereal),e.raycaster=new v.Raycaster,e.bgColor=new v.Color(16777215),e.mouse=new v.Vector2,e.scene.background=e.bgColor,T(z,(function(e){})),e.resize(),e}return(0,o.Z)(a,[{key:"resize",value:function(){var e=window.innerWidth,n=window.innerHeight;this.camera.aspect=e/n,this.camera.updateProjectionMatrix(),this.ethereal.material.uniforms.resolution.value.set(e,n),this.renderer.setSize(e,n)}},{key:"earlyUpdate",value:function(e,n){(0,f.Z)((0,l.Z)(a.prototype),"earlyUpdate",this).call(this,e,n)}},{key:"update",value:function(e,n){(0,f.Z)((0,l.Z)(a.prototype),"update",this).call(this,e,n),P.USE_POSTPROCESS?this.postProcess.render(this.scene,this.camera,e):this.renderer.render(this.scene,this.camera)}},{key:"lateUpdate",value:function(e,n){(0,f.Z)((0,l.Z)(a.prototype),"lateUpdate",this).call(this,e,n),this.controls&&this.controls.update()}}]),a}(G);var re=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(e){var n,t=e.fov,o=e.aspect,s=e.near,c=e.far,u=e.range,l=e.panAmount,d=e.rotateSpeed,f=e.rotationDamping,h=void 0===f?3:f;return(0,i.Z)(this,a),(n=r.call(this,t,o,s,c)).runGaze=!1,n.mouse=new v.Vector2,n.target=new v.Vector3,n.range=u,n.panAmount=l,n.rotationDamping=h,n.rotateSpeed=d,n.parentObject=null,T(z,n._handleTouchMove.bind((0,$.Z)(n))),T(_,n.update.bind((0,$.Z)(n))),window.addEventListener("mousemove",(function(){n.lockToCenter?n.target=new v.Vector3(0,0,-1):n.target=new v.Vector3(n.mouse.x,n.mouse.y,-1).multiply(new v.Vector3(n.range.x,n.range.y,0))})),n}return(0,o.Z)(a,[{key:"_handleTouchMove",value:function(e){var n=e.normalized;this.mouse.set(n.x,n.y)}},{key:"update",value:function(e){var n=e.delta;if(this.runGaze){var t=this.quaternion.clone(),r=new v.Vector3(0,1,-20);r.x+=this.panAmount.x*(this.target.x-r.x),r.y+=this.panAmount.y*(this.target.y-r.y),this.lookAt(r);var i=new v.Vector3;this.getWorldPosition(i);var o=this.quaternion.clone();this.quaternion.copy(o),v.Quaternion.slerp(t,o,this.quaternion,n*this.rotationDamping)}}}]),a}(v.PerspectiveCamera),ie={rotationDamping:3,panAmount:new v.Vector2(.06,.06),range:new v.Vector2(40,40),fov:50,near:.01,far:1e4,aspect:window.innerWidth/window.innerHeight};var oe=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e;return(0,i.Z)(this,a),(e=r.call(this,ie)).position.set(0,0,1),e.runGaze=!1,m("controls")&&(e.position.set(0,0,5),e.lookAt(0,0,0),e.runGaze=!1),e}return(0,o.Z)(a,null,[{key:"getInstance",value:function(){return a.instance||(a.instance=new this),a.instance}}]),a}(re),ae=function(){function e(){(0,i.Z)(this,e),this.world=te,this.camera=oe.getInstance()}return(0,o.Z)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new this),e.instance}}]),e}(),se=t(2975),ce=t(4942),ue=t(9233),le="update_screen",ve="assets_loading",de="update_gpu_tier",fe="loading";function he(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?he(Object(t),!0).forEach((function(n){(0,ce.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):he(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var me={screen:fe,assetsLoading:!0,mute:!1,device:{gpuTier:3}},pe=new ue.X(me),ye=new E.xQ;ye.subscribe((function(e){switch(e.type){case de:me=ge(ge({},me),{},{device:ge(ge({},me.device),{},{gpuTier:e.payload})}),pe.next(me);break;case le:me=ge(ge({},me),{},{screen:e.payload}),pe.next(me);break;case ve:me=ge(ge({},me),{},{assetsLoading:e.payload}),pe.next(me);break;case"update_mute":me=ge(ge({},me),{},{mute:e.payload}),pe.next(me)}}));var xe=[],we=t(7027),be=(t(6564),t(725),t(5317)),Pe=t(9975);be.ZP.registerPlugin(Pe._Z);var Se=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return be.ZP.fromTo(e,{opacity:0},{opacity:1,duration:n,delay:t,ease:be.Lp.easeOut,onComplete:function(){r&&r()}})};'\n                    <div class="loading-bar">\n                        <div class="loading-bar-progress"></div>\n                    </div>\n                    '.concat('<svg xmlns="http://www.w3.org/2000/svg" width="38.43" height="63.77">\n  <defs>\n  </defs>\n  <path fill="#fff" d="M13.52 7.45c-.12 1.18 2 1.7 1.9 0-.05-1.17-1.94-1.4-1.9 0M16.21 6.49s0 .25 0 .13c.14.55.35 1 1 1.12a.93.93 0 0 0 1.13-.67c.2-1.14-2-2-2.11-.58"/>\n  <path fill="#fff" d="M30.34,34.26s.32,2.65.41,6.11c.06,2,0,3.93-.07,5.67a33,33,0,0,1-.77,5.63c-1.41,5.9-2,7.51-2,7.56s-.2.78-.67-.56c0,0-1.52-3.32-2.86-6.77-.77-2-1.42-3.82-1.95-5.51A40.31,40.31,0,0,1,21.1,41a1.21,1.21,0,0,0-.05-.18,1.06,1.06,0,0,0-1-.69h0c-.81,0-1.15.85-1.28,1.18-.24.6-1.15,3.61-1.9,6.18-.61,2.08-1.65,5.76-1.86,7-.16,1-.46,2.31-.79,1.37a81.14,81.14,0,0,1-3.48-7.82A54.12,54.12,0,0,1,9,42.84a14.26,14.26,0,0,1-.6-4.16.91.91,0,0,0-.67-.92.94.94,0,0,0-1,.48s-.26.53-.62,1.09-.73.39-.82.06a26.6,26.6,0,0,1-.48-2.69,58.8,58.8,0,0,1-.46-7.29v-.05a15.06,15.06,0,0,1,.76-4.79A18.91,18.91,0,0,1,7.28,20a20.83,20.83,0,0,1,4.44-4.88,1,1,0,0,0,.17-.18l.12-.17a2.06,2.06,0,0,0,.38-.69,1.66,1.66,0,0,0-.08-1v0s-.41-1-.75-2.27a7.47,7.47,0,0,1-.42-3.38A4.46,4.46,0,0,1,14.76,4a5,5,0,0,1,1.12-.14h0a3.12,3.12,0,0,1,2.18.85,8.46,8.46,0,0,1,2,3.74.91.91,0,0,0,.49.56A17.93,17.93,0,0,1,24,11.18a22.15,22.15,0,0,1,3.14,2.89,20.38,20.38,0,0,1,2.94,4.22A30,30,0,0,1,32,23a50.06,50.06,0,0,1,1.48,5.78,25.26,25.26,0,0,1,.53,5,6.07,6.07,0,0,1-.21,1.57c-.05.49-.61,0-1.05-.6S32,33.71,32,33.71a.9.9,0,0,0-.78-.45.69.69,0,0,0-.28.05.88.88,0,0,0-.61.95m5.14-5.85a45.35,45.35,0,0,0-3.54-11.07,22.46,22.46,0,0,0-3.24-4.65,24.44,24.44,0,0,0-3.42-3.15,22.83,22.83,0,0,0-3.39-2.16,9.58,9.58,0,0,0-2.44-4.16,5.1,5.1,0,0,0-3.57-1.4,7,7,0,0,0-1.6.19,7.2,7.2,0,0,0-3.39,1.76A6,6,0,0,0,9.12,6.89a9.65,9.65,0,0,0,.45,4.39c.29,1,.61,1.93.74,2.29v0a22.84,22.84,0,0,0-4.78,5.32,20.91,20.91,0,0,0-2.4,5.14,17.33,17.33,0,0,0-.82,5.39,58.93,58.93,0,0,0,.58,8.23,20.36,20.36,0,0,0,.63,2.94,4.56,4.56,0,0,0,.46,1,1.57,1.57,0,0,0,1.33.82,2.12,2.12,0,0,0,1.4-.6,44.91,44.91,0,0,0,2.14,6.91,80.89,80.89,0,0,0,3.59,8.07c.22.41.9,1.67,2.12,1.67.55,0,1.34-.26,1.91-1.52a8.79,8.79,0,0,0,.6-2.17c.24-1.42,1.76-6.68,2.78-10a78,78,0,0,0,2.64,7.85c1.37,3.51,2.66,6.31,2.91,6.81l.06.11a7.62,7.62,0,0,0,.76,1.34,2.12,2.12,0,0,0,1.71.91,1.9,1.9,0,0,0,1.74-1.24,4.7,4.7,0,0,0,.24-.75c.12-.37.71-2.24,2-7.68a46.45,46.45,0,0,0,.9-11.86c0-.88-.06-1.78-.12-2.68a2,2,0,0,0,1,.29,1.59,1.59,0,0,0,.83-.22c1-.56,1.47-1.81,1.52-3.81a26.53,26.53,0,0,0-.57-5.46"/>\n</svg>\n',"\n                    ");var Re=t(2982),_e=function(){function e(n){var t=n.name,r=void 0===t?"":t,o=n.additionalClasses,a=void 0===o?[]:o;if((0,i.Z)(this,e),this.name=r,this.active=!1,this.events=[],this.transitions=[],this.transitionRunning=!1,this.additionalClasses=a,(this instanceof e?this.constructor:void 0)===e)throw new TypeError("Cannot construct Abstract instances directly")}return(0,o.Z)(e,[{key:"getContainer",value:function(){var e,n=document.createElement("div");return(e=n.classList).add.apply(e,["screen",this.name.replace(/_/g,"-")].concat((0,Re.Z)(this.additionalClasses))),n}},{key:"cleanUp",value:function(e,n){n.removeChild(e),this.events.length>0&&(this.events.forEach((function(e){return e.unsubscribe()})),this.events=[]),this.transitions.length>0&&(this.transitions.forEach((function(e){e.seek(e.vars.duration),e.kill()})),this.transitions=[])}},{key:"initListeners",value:function(){}},{key:"initTransitions",value:function(){}},{key:"onResize",value:function(){}},{key:"onEnter",value:function(){}},{key:"onExit",value:function(){}}]),e}(),ze=t(7713),Ee=t.n(ze);var Ce=function(e){(0,c.Z)(d,e);var n,t,a,v=(t=d,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,l.Z)(t);if(a){var r=(0,l.Z)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return(0,u.Z)(this,e)});function d(e){var n,t=e.name;return(0,i.Z)(this,d),(n=v.call(this,{name:t})).name=t,n.canvas=document.getElementById("experience"),n.root="",n.localState={scrollPercent:0},n.currentState={scrollProgess:0},n}return(0,o.Z)(d,[{key:"generateHTML",value:function(e){return this.container=this.getContainer(),this.container.innerHTML="\n    ",e.appendChild(this.container),this.initListeners(),this.container}},{key:"initListeners",value:function(){var e=this;this.scrollProgressBar=document.querySelector(".scroll-progress"),pe.subscribe((function(n){n.scrollProgress!==e.currentState.scrollProgress&&e._handleScrollUpdate(n.scrollProgress),e.currentState=n}))}},{key:"_handleScrollUpdate",value:function(e){var n=this;be.ZP.to(this.localState,{scrollPercent:e,duration:.5,ease:be.EA.easeOut,onUpdate:function(){n.scrollProgressBar.style.width="".concat(n.localState.scrollPercent||0,"%")}})}},{key:"onEnter",value:(n=(0,r.Z)(s().mark((function e(n){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.root=n,this.generateHTML(n),t=be.ZP.to(this.canvas,{opacity:1,duration:.25,ease:be.bJ}),r=Se(this.container,2,0),this.transitions.push(r,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),d}(_e);var Le=function(e){(0,c.Z)(a,e);var n,t,r=(n=a,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(n);if(t){var i=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,u.Z)(this,e)});function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.injectPosition,o=n.screenEnter,s=n.screenExit;return(0,i.Z)(this,a),(e=r.call(this,{injectPosition:t,screenEnter:o,screenExit:s})).appState={},e}return(0,o.Z)(a,[{key:"generateHTML",value:function(e){this.container=document.createElement("div"),this.container.classList.add("rotate-device");var n="\n        ".concat(function(){return'<a class="logo '.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",'" href="https://www.phantom.land" target="_blank">\n          <img src="static/images/phntm-logo-invert.svg" alt="phantom logo" />\n      </a> ')}(),'\n        <div class="inner-container">\n            <span><img src="static/images/icon-portrait.svg" alt="Rotate device"></span>\n            <h2>Rotate your device</h2>\n            <p>Please keep your phone in portrait mode</p>\n        </div>\n        ');this.container.innerHTML+=n,e.insertAdjacentElement(this.injectPosition,this.container),this.initListeners()}},{key:"initListeners",value:function(){this.logoClick=(0,we.R)(this.container.querySelector(".logo"),"click");var e=this.logoClick.subscribe((function(){window.gtag("event","click",{event_category:"button",event_label:"header logo"})}));this.events.push(e)}},{key:"onEnter",value:function(e){this.attached||(this.generateHTML(e),this.attached=!0)}},{key:"onExit",value:function(e){this.attached=!1,this.cleanUp(this.container,e)}}]),a}(function(){function e(n){var t=n.injectPosition,r=n.screenEnter,o=n.screenExit;if((0,i.Z)(this,e),this.screenEnter=r||null,this.screenExit=o||null,this.injectPosition=t,this.attached=!1,this.events=[],this.transitions=[],(this instanceof e?this.constructor:void 0)===Screen)throw new TypeError("Cannot construct Abstract instances directly")}return(0,o.Z)(e,[{key:"cleanUp",value:function(e,n){n.removeChild(e),this.events.length>0&&this.events.forEach((function(e){return e.unsubscribe()})),this.transitions.length>0&&this.transitions.forEach((function(e){return e.kill()}))}},{key:"initListeners",value:function(){}},{key:"onEnter",value:function(){}},{key:"onExit",value:function(){}}]),e}()),Ze=function(){function e(){var n;(0,i.Z)(this,e),this.uiHTMLContainer=document.getElementById("ui"),this.uiHTMLContainer.style.display="none",n=fe,ye.next({type:le,payload:n}),this.screens=[],this.layoutComponents=[],this.currentState={},this.localState={},(0,we.R)(window,"click").subscribe((function(){}))}return(0,o.Z)(e,[{key:"init",value:function(){var e=this;this.initLayoutComponents(),this.initScreens(),pe.subscribe((function(n){e.handleStateUpdate(n),e.currentState=n}))}},{key:"initLayoutComponents",value:function(){var e=new Le({screenEnter:fe,injectPosition:"afterbegin"});this.layoutComponents.push(e)}},{key:"initScreens",value:function(){var e=this;this.screens.push(new Ce({name:"experience"})),(0,we.R)(window,"resize").subscribe((function(){e.screens.forEach((function(e){return e.onResize()}))}))}},{key:"handleStateUpdate",value:function(e){this.currentState.screen!==e.screen&&(this.runScreenTransitions(e),this.runLayoutTransitions(e))}},{key:"runLayoutTransitions",value:function(e){var n=this;this.layoutComponents.forEach((function(t){t.screenEnter===e.screen&&t.onEnter(n.uiHTMLContainer),t.screenExit===e.screen&&t.onExit(n.uiHTMLContainer)}))}},{key:"runScreenTransitions",value:function(e){var n=this;this.screens.forEach((function(t){var r,i=document.querySelector("".concat((r=t.name,".".concat(r.replace(/_/g,"-")))));t.name===e.screen?(t.active=!0,t.onEnter(n.uiHTMLContainer)):(t.active&&t.onExit(i,n.uiHTMLContainer),t.active=!1)}))}}]),e}(),ke=t(6230),Te=function(){function e(){(0,i.Z)(this,e),this.mediator=ae.getInstance(),this.renderer=d.getInstance(),this.assetManager=Ee().getInstance(),this.world=null,this.loading=!1,this.assetManager.setLoaders({cubeTexture:ke.CubeTextureLoader,texture:ke.TextureLoader,gltf:ke.GLTFLoader}),this._start()}return(0,o.Z)(e,[{key:"beginLoad",value:function(){var e=this;this.loading=!0,this.assetManager.setAssets(xe,16),0===xe.length?this._start():this.assetManager.onPreloaded.subscribe((function(){e._start()}))}},{key:"_start",value:function(){var e=this;this.world=new this.mediator.world,this.world.start(),window.addEventListener("resize",(function(){e.world.resize(window.innerWidth,window.innerHeight)})),ye.next({type:ve,payload:false})}},{key:"init",value:function(){(0,r.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,se.M)();case 2:n=e.sent,t=n.tier,ye.next({type:de,payload:t});case 5:case"end":return e.stop()}var t}),e)})))(),new Ze(this.assetManager).init()}}]),e}()}}]);